{{- $currentPage := . -}}
<nav class="nav-container">
  <div class="uk-container uk-navbar-container" data-uk-navbar="offset: 0px">
    <ul class="uk-navbar-nav">
      <li>
        <a class="nav-cmu-delphi-logo" href="{{ relref . "/" }}" title="Go to the main page"
          ><span>Delphi Group</span></a
        >
      </li>
    </ul>
    <ul class="uk-navbar-nav nav-entries">
      {{ range .Site.Menus.main.ByWeight }}
        <li
          class="nav-entry {{ if (eq $currentPage.Section .Identifier) -}}uk-active{{ end -}} {{ if .HasChildren -}}
            uk-parent
          {{- end -}}"
        >
          {{ if .HasChildren }}
            <a
              href="{{ .URL | relLangURL }}"
              {{ if .Params.external }}
                target='_blank'
              {{ end }}
            >
              {{ partial "menu/item.html" . }}
              {{ if .Params.external }}
                <div class="external-link">
                  {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                </div>
              {{ end }}
              {{ partial "font-awesome.html" "solid/angle-down" }}
            </a>
            <div class="uk-navbar-dropdown">
              <ul class="uk-nav uk-navbar-dropdown-nav">
                {{ range .Children }}
                  <li>
                    <a
                      href="{{ .URL | relLangURL }}"
                      {{ if  .Params.external }}
                        target='_blank'
                      {{ end }}
                    >
                      {{ partial "menu/item.html" . }}
                      {{ if .Params.external }}
                        <div class="external-link">
                          {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                        </div>
                      {{ end }}
                      {{ if .HasChildren }}
                        {{ partial "font-awesome.html" "solid/angle-right" }}
                      {{ end }}
                    </a>
                    {{ if .HasChildren }}
                      <div class="uk-navbar-dropdown" uk-dropdown="pos: right-center; shift: false; flip: false;">
                        <ul class="uk-nav uk-navbar-dropdown-nav">
                          {{ range .Children }}
                            <li>
                              <a
                                href="{{ .URL | relLangURL }}"
                                {{ if  .Params.external }}
                                  target='_blank'
                                {{ end }}
                              >
                                {{ partial "menu/item.html" . }}
                                {{ if .Params.external }}
                                  <div class="external-link">
                                    {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                                  </div>
                                {{ end }}
                              </a>
                            </li>
                          {{ end }}
                        </ul>
                      </div>
                    {{ end }}
                  </li>
                {{ end }}
              </ul>
            </div>
          {{ else }}
            <a
              href="{{ .URL | relLangURL }}"
              {{ if .Params.external }}
                target='_blank'
              {{ end }}
            >
              {{ partial "menu/item.html" . }}
              {{ if .Params.external }}
                <div class="external-link">
                  {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                </div>
              {{ end }}
            </a>
          {{ end }}
        </li>
      {{ end }}
    </ul>
    <div class="nav-spacer"></div>
    <ul class="uk-navbar-nav nav-burger">
      <li>
        <a class="uk-navbar-toggle nav-toggle" uk-navbar-toggle-icon href="" title="Toggle Menu"></a>
        <div
          class="nav-mobile"
          uk-dropdown="mode: click; offset: 0; position: bottom-right; shift: false; flip: false;"
        >
          <ul class="uk-nav uk-navbar-dropdown-nav">
            {{ range .Site.Menus.main.ByWeight }}
              <li
                class="nav-dropdown-parent {{ if .HasChildren -}}
                  uk-nav-header
                {{- end -}} {{ if (eq $currentPage.Section .Identifier) -}}uk-active{{- end -}}"
              >
                <a
                  href="{{ .URL | relLangURL }}"
                  {{ if  .Params.external }}
                    target='_blank'
                  {{ end }}
                >
                  {{ partial "menu/item.html" . }}
                  {{ if .Params.external }}
                    <div class="external-link">
                      {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                    </div>
                  {{ end }}
                </a>
              </li>
              {{ if .HasChildren }}
                {{ range .Children }}
                  <li class="nav-dropdown-child">
                    <a
                      href="{{ .URL | relLangURL }}"
                      {{ if  .Params.external }}
                        target='_blank'
                      {{ end }}
                    >
                      {{ partial "menu/item.html" . }}
                      {{ if .Params.external }}
                        <div class="external-link">
                          {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                        </div>
                      {{ end }}
                    </a>
                  </li>
                  {{ if .HasChildren }}
                    <li class="nav-dropdown-child">
                      <ul class="nestedmenu">
                        {{ range .Children }}
                          <li>
                            <a
                              href="{{ .URL | relLangURL }}"
                              {{ if  .Params.external }}
                                target='_blank'
                              {{ end }}
                            >
                              {{ partial "menu/item.html" . }}
                              {{ if .Params.external }}
                                <div class="external-link">
                                  {{ partial "font-awesome.html" "solid/arrow-up-right-from-square" }}
                                </div>
                              {{ end }}
                            </a>
                          </li>
                        {{ end }}
                      </ul>
                    </li>
                  {{ end }}
                {{ end }}
              {{ end }}
            {{ end }}
          </ul>
        </div>
      </li>
    </ul>
  </div>
</nav>
